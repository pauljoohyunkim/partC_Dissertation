%        File: FourierSeriesCurveRepulsion.tex
%     Created: Thu Feb 09 10:00 AM 2023 G
% Last Change: Thu Feb 09 10:00 AM 2023 G
%
\documentclass[a4paper]{article}
\usepackage[]{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}

\title{Gradient Flow to Continuous Optimization via Fourier Series}
\author{Paul Kim}

\newcommand{\dx}{\, \text{d} x}
\newcommand{\dgamma}{\, \text{d} \gamma}
\newcommand{\dgammabf}{\, \text{d} \boldsymbol{\gamma}}
\newcommand{\norm}[1]{||#1||}

\DeclareMathOperator{\grad}{grad}

\begin{document}
\maketitle

We've been concerned about minimizing the energy functional of the form:
\begin{equation}
    \mathcal{E} (\boldsymbol{\gamma}) \coloneqq \int_{C_{\boldsymbol{\gamma}}} \int_{C_{\boldsymbol{\gamma}}} k\left( \boldsymbol{\gamma}_1, \boldsymbol{\gamma}_2 \right) \dgammabf_1 \dgammabf_2
\end{equation}
where $\boldsymbol{\gamma}: E \rightarrow \mathbb{R}^{3}$ is a parameterization function of a closed curve on the interval $E = [ 0, 2\pi )$ (without loss of generality).

Note that we assume $\boldsymbol{\gamma}$ to be a periodic function of period $2 \pi$.

\section{Multidimensional Fourier Series}
\subsection{1D Fourier Series}
Given a continuous 1D $2\pi$-periodic function $f: \mathbb{R} \rightarrow \mathbb{R}$ (where we only need to define $f$ on $[0, 2\pi)$), there exists a Fourier series representation:
\begin{align}
    f (x) &= \frac{a_0}{2} + \sum_{n = 1}^{\infty} \left( a_n \cos {\left( nx \right)} + b_n \sin {\left( nx \right)} \right) \\
    &= \sum_{n=-\infty}^{\infty} c_n e^{i n x}
\end{align}
where the coefficients $\left\{ a_n \right\}, \left\{ b_n \right\}, \left\{ c_n \right\}$ are given by
\begin{align}
    a_n &= \frac{1}{\pi} \int_{0}^{2\pi} f(x) \cos {\left( nx \right)} \dx &\in \mathbb{R}\\
    b_n &= \frac{1}{\pi} \int_{0}^{2\pi} f(x) \sin {\left( nx \right)} \dx &\in \mathbb{R} \\
    c_n &= \frac{1}{2 \pi} \int_{0}^{2\pi} f(x) e^{-inx} \dx &\in \mathbb{C}
\end{align}
Fourier convergence theorem states that the rate of convergence is $O\left( \frac{1}{n^{p+1}} \right)$ where $f$ has the first jump discontinuity in the $p$\textsuperscript{th} derivative.\footnote{Lecture note}

\subsection{Multidimensional Extension}
For a vector valued function of dimension $N$ (which we will take $N=3$ for our case), we have Fourier series representation in each of the coordinates.

For $\mathbf{f}:\mathbb{R} \rightarrow \mathbb{R}^N$, we write its Fourier series as:
\begin{align}
    \mathbf{f} (x) &= \frac{1}{2}
    \begin{pmatrix}
        a_{1,0} \\
        a_{2,0} \\
        \vdots \\
        a_{N,0}
    \end{pmatrix}
    + \sum_{n=1}^\infty
    \begin{pmatrix}
        a_{1,n} & b_{1,n} \\
        a_{2,n} & b_{2,n} \\
        \vdots \\
        a_{N,n} & b_{N,n}
    \end{pmatrix}
    \begin{pmatrix}
        \cos {\left( nx \right)} \\
        \sin {\left( nx \right)}
    \end{pmatrix}
    %\begin{pmatrix}
    %    a_{1,n} \cos {\left( nx \right)} + b_{1,n} \sin {\left( nx \right)} \\
    %    a_{2,n} \cos {\left( nx \right)} + b_{2,n} \sin {\left( nx \right)} \\
    %    \vdots \\
    %    a_{N,n} \cos {\left( nx \right)} + b_{N,n} \sin {\left( nx \right)} \\
    %\end{pmatrix}
    \\
    &= \sum_{n=-\infty}^{\infty}
    \begin{pmatrix}
        c_{1,n} \\
        c_{2,n} \\
        \vdots \\
        c_{N,n}
    \end{pmatrix}
    e^{-inx}
\end{align}
where the coefficients $\left\{ a_{i,n} \right\}, \left\{ b_{i,n} \right\}, \left\{ c_{i,n} \right\}$ are given by
\begin{align}
    a_{i,n} &= \frac{1}{\pi} \int_{0}^{2\pi} f_i (x) \cos {\left( nx \right)} \dx \\
    b_{i,n} &= \frac{1}{\pi} \int_{0}^{2\pi} f_i (x) \sin {\left( nx \right)} \dx \\
    c_{i,n} &= \frac{1}{2\pi} \int_{0}^{2\pi} f_i (x) e^{-inx} \dx
\end{align}
for $i=1, 2, \cdots, N$

\section{Gradient Flow to Continuous Optimization}
For minimization of $\mathcal{E}$, the original approach is to use the gradient flow equation:
\begin{equation}
    \frac{\partial \mathcal{E}}{\partial t} = - \grad_X {E}
\end{equation}
where $\grad_X$ is gradient on inner product space $X$.

This is needed as a description of reduction of functional $\mathcal{E}$ was needed.
For a solution, one would could use a numerical method to solve the differential equation
by sampling at different points on the curve.

However, consider expressing $\boldsymbol{\gamma}(t)$ as a 3D Fourier series as:
\begin{equation}
    \boldsymbol{\gamma}(t) = \sum_{n=-\infty}^{\infty} \mathbf{c}_n e^{-int}
\end{equation}

One could approximate this to $J$ terms:
\begin{equation}
    \boldsymbol{\gamma}_N (t) = \sum_{n = -J}^{J} \mathbf{c}_n e^{-int}
\end{equation}
(Noting $\norm{\boldsymbol{\gamma} - \boldsymbol{\gamma}_J} = O\left( \frac{1}{J^{p+1}} \right)$)

Then now the reduction process of $\mathcal{E}\left( \gamma \right)$ can be approximated by the reduction process of $\mathcal{E}\left( \gamma_J \right)$.
It is paramount to note that $\mathcal{E} \left( \gamma_J \right): \mathbb{R}^{3\left( 2J + 1 \right)} = \mathbb{R}^{6J + 3} \rightarrow \mathbb{R}$ where the parameters are the Fourier coefficients in 3D.
The idea is now to consider this a standard optimiation problem:
\begin{equation}
    \min_{\left[ \mathbf{c}_{-J}, \cdots, \mathbf{c}_{J} \right]} \mathcal{E} \left( \gamma_J \right)
\end{equation}
which can be attempted by standard techniques such as SDM, bArmijo linesearch, etc.

\subsection{Complexity}
For a general approximation of $\mathcal{E}\left( \gamma_J \right)$,
\begin{itemize}
    \item Evaluation of the energy functional $\mathcal{E} \left( \gamma_J \right)$ takes $O\left( J \log J \right)$ operations via FFT and possibly Clenshaw-Curtis quadrature.
    \item Other operations might be of lower order? 
\end{itemize}

\end{document}


