%        File: Dirichlet Energy.tex
%     Created: Fri Dec 02 07:00 PM 2022 G
% Last Change: Fri Dec 02 07:00 PM 2022 G
%
\documentclass[a4paper]{article}
\usepackage[]{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtools}



\newcommand{\llangle}{\langle \langle}
\newcommand{\rrangle}{\rangle \rangle}
\newcommand{\dx}{\, \text{d} x}
\newcommand{\dxx}{\, \text{d} \mathbf{x}}


\theoremstyle{definition}
\newtheorem{definition}{Definition}

\DeclareMathOperator{\grad}{grad}

\title{Dirichlet Energy in Different Spaces}
\author{ }

\begin{document}
\maketitle
\section{Relevant Definitions}
\begin{definition}[Gradient Flow]
    Given an energy (functional) $\mathcal{E}(f)$, \emph{gradient flow} is:
    \begin{equation}
        \frac{d}{dt}f = - \grad \mathcal{E}(f)
        \label{equ: Gradient Flow}
    \end{equation}
\end{definition}

\begin{definition}[Differential]
    \emph{Differential} $d\mathcal{E}$ describes change in $\mathcal{E}$ due to\footnote{analogous in traditional vector space would be ``in the direction of'' $u$} $u$:
    \begin{equation}
        d \mathcal{E}|_f(u) = \lim_{\epsilon \rightarrow 0} \frac{1}{\epsilon} \left( \mathcal{E}(f+\epsilon u) - \mathcal{E}(f) \right)
        \label{equ: Differential}
    \end{equation}
\end{definition}

\begin{definition}[Gradient]
    \emph{Gradient} of $\mathcal{E}$ is the unique function $\grad \mathcal{E}$ such that,
    \begin{equation}
        \llangle \grad \mathcal{E}, u \rrangle_V = d \mathcal{E}(u)
        \label{equ: Gradient}
    \end{equation}
\end{definition}

\section{Dirichlet Energy Example}

\begin{definition}[Dirichlet Energy]
    Dirichlet Energy is defined as:
    \begin{equation}
        \mathcal{E}_D(f) \coloneqq \frac{1}{2} \int_{\Omega} |\grad f(x)|^2 \dx
        = \frac{1}{2} \llangle \nabla f, \nabla f \rrangle_{L^2}
        = -\frac{1}{2} \llangle \Delta f, f \rrangle_{L^2}
        \label{equ: Dirichlet Energy}
    \end{equation}
\end{definition}

Computing the differential $d \mathcal{E}_D|_f (u)$ of Dirichlet energy using (\ref{equ: Differential}),
\begin{align}
    d \mathcal{E}_D|_f(u) &= -\frac{1}{2} \lim_{\epsilon \rightarrow 0} \frac{1}{\epsilon} \left( \llangle \Delta (f+\epsilon u), f + \epsilon u \rrangle_{L^2} - \llangle \Delta f, f \rrangle_{L^2} \right) \\
    &= -\frac{1}{2} \lim_{\epsilon \rightarrow 0} \frac{1}{\epsilon} \left( \epsilon \llangle \Delta f, u \rrangle_{L^2} + \epsilon \llangle \Delta u, f \rrangle_{L^2} + \epsilon^2 \llangle u, u \rrangle_{L^2} \right) \\
    &= -\frac{1}{2} (\llangle \Delta f,u \rrangle_{L^2} + \llangle \Delta u, f \rrangle_{L^2}) \\
    &= -\frac{1}{2} (\llangle \Delta f,u \rrangle_{L^2} + \llangle \Delta f, u \rrangle_{L^2}) \\
    &= -\llangle \Delta f, u \rrangle_{L^2}
    \label{equ: Dirichlet Differential}
\end{align}
where the last step is by integration by parts (twice)\footnote{This trick will be used all over the place when constructing gradients. See \ref{sct: IBP Justification} in the Appendix}.

\subsection{Gradient Flow in $L^2$}
By (\ref{equ: Gradient}), we may spot from (\ref{equ: Dirichlet Differential}) that the gradient can be written as
\begin{equation}
    \grad \mathcal{E}_{L^2} = - \Delta f
    \label{equ: L2 Gradient}
\end{equation}
Hence, the gradient flow equation (\ref{equ: Gradient Flow}) can be written as:
\begin{equation}
    \frac{d}{dt} f = \Delta f
    \label{equ: L2 Gradient Flow}
\end{equation}
which is the heat equation.


\subsection{Gradient Flow in $H^1$}
We may express the differential (\ref{equ: Dirichlet Differential}) as
\begin{align}
    d \mathcal{E}_D|_f (u) &= - \llangle \Delta f, u \rrangle_{L^2} \\
    &= \llangle \nabla f, \nabla u \rrangle_{L^2} \\
    &= \llangle f, u \rrangle_{H^1}
    \label{equ: Gradient H1 Derivation}
\end{align}
So by (\ref{equ: Gradient}), the gradient in $H^1$ can be written as
\begin{equation}
    \grad \mathcal{E}_{H^1} = f
    \label{equ: H1 Gradient}
\end{equation}
The gradient flow equation (\ref{equ: Gradient Flow}) can be written as
\begin{equation}
    \frac{d}{dt}f = -f
    \label{equ: H1 Gradient Flow}
\end{equation}
which describes exponential decay.

\subsection{Gradient Flow in $H^{-1}$}
We may express the differential (\ref{equ: Dirichlet Differential}) as
\begin{align}
    d \mathcal{E}_D|_f (u) &= - \llangle \Delta f, u \rrangle_{L^2} \\
    &= \llangle \nabla f, \nabla u \rrangle_{L^2} \\
    &= \llangle \nabla^3 f, \nabla^{-1} u \rrangle_{L_2} \\
    &= \llangle \Delta f, \Delta^{-1} u \rrangle_{H^1} \\
    &= \llangle \Delta^2 f, u \rrangle_{H^{-1}}
    \label{equ: Gradient H-1 Derivation}
\end{align}
So by (\ref{equ: Gradient}), the gradient in $H^{-1}$ can be written as
\begin{equation}
    \grad \mathcal{E}_{H^{-1}} = \Delta^2 f
    \label{equ: H-1 Gradient}
\end{equation}
The gradient flow equation (\ref{equ: Gradient Flow}) can be written as
\begin{equation}
    \frac{d}{dt}f = - \Delta^2 f
    \label{equ: H-1 Gradient Flow}
\end{equation}

\subsection{Gradient Flow in $H^2$}
We may express the differential (\ref{equ: Dirichlet Differential}) as
\begin{align}
    d \mathcal{E}_D|_f (u) &= - \llangle \Delta f, u \rrangle_{L^2} \\
    &= -\llangle f, \Delta u \rrangle_{L^{2}} \\
    &= -\llangle \Delta^{-1} f, u \rrangle_{H^2}
    \label{equ: Gradient H2 Derivation}
\end{align}
So by (\ref{equ: Gradient}), the gradient in $H^2$ can be written as
\begin{equation}
    \grad \mathcal{E}_{H^2} = - \Delta^{-1} f
    \label{equ: H2 Gradient}
\end{equation}
The gradient flow equation (\ref{equ: Gradient Flow}) can be written as
\begin{equation}
    \frac{d}{dt}f = \Delta^{-1} f
    \label{equ: H2 Gradient Flow}
\end{equation}


\newpage
\section{Appendix}
\subsection{A (Somewhat) Careful Justification for IBP}
\label{sct: IBP Justification}
Suppose we are concerned with the integral $I \coloneqq \llangle \Delta u, f \rrangle_{L^2} = \int_{\mathbb{R}^n} (\Delta u)f \dxx$.
We may assume that $u$ and $f$ decays sufficiently fast for the integral to be defined.

\subsubsection{IBP (on Laplacian Operator)}
Note the vector calculus identity\footnote{Sometimes known as \emph{Green's identity}}:
\begin{equation}
    \psi \nabla^2 \phi - \phi \nabla^2 \psi = \nabla \cdot \left( \psi \nabla \phi - \phi \nabla \psi \right)
    \label{equ: Green's Identity}
\end{equation}

Now, we can think of $I$ as an integral $I_R$ over a spherical region of radius $R$, and taking the radius $R$ to be infinite,
that is $I_R \stackrel{R \rightarrow \infty}{\longrightarrow} I$.

We use (\ref{equ: Green's Identity}), taking $\phi = u$, $\psi = f$, to shift the Laplacian:
\begin{align}
    I_R &= \int_{V_R} (\nabla^2 u) f \dxx \\
    &= \int_{V_R} u \nabla^2 f \dxx + \int_{V_R} \nabla \cdot \left( f \nabla u - u \nabla f \right) \dxx \\
    &= \int_{V_R} u \nabla^2 f \dxx + \int_{\partial V_R} \left( f \nabla u - u \nabla f \right) \cdot \, \text{d} \mathbf{S} \\
    &\stackrel{R \rightarrow \infty}{\longrightarrow}
    \int_{\mathbb{R}^n} u \nabla^2 f \dxx \\
    &= \llangle u, \Delta f \rrangle_{L^2}
    \label{equ: Sufficient Decay on Boundary}
\end{align}
where (\ref{equ: Sufficient Decay on Boundary}) is from assuming sufficiently fast decay of $f$ and $u$ at infinity.
The limit quantity should equal $I$.

\subsubsection{IBP (on Gradient Operator)}
One could show that 
\begin{equation}
    \llangle \Delta u, f \rrangle = - \llangle \nabla u, \nabla f \rrangle = \int \nabla u \cdot \nabla f \dxx
    \label{equ: IBP Gradient}
\end{equation}
using a similar strategy, but by a different identity\footnote{This is also known as Green's Identity in some literature}:
\begin{equation}
\nabla \cdot \left( \phi \nabla \psi \right) = \phi \nabla^2 \psi + \nabla \phi \cdot \nabla \psi
    \label{equ: Green's Identity II}
\end{equation}


\end{document}


